# HTTP 메서드 속성



## HTTP 메서드의 속성
- 안전(Safe Methods)
- 멱등(Idempotent Methods)
- 캐시가능(Cacheable Methods)


## 안전 Safe
- 호출해도 리소스가 변경되지 않는다 (GET,HEAD 메서드만 POST,PUT,DELETE는 호출하면 리소스가 변경되니까)
- Q: 그래도 계속 호출해서, 로그 같은게 쌓여서 장애가 발생한다면?
- A: 안전은 해당 리소스만 고려한다. 그런 부분 까지는 고려하지 않는다.

<br>

## 멱등 Idempotent
- f(f(x)) = f(x)
- 한 번 호출하든 두 번 호출하든 100번 호출하든 결과가 똑같다.
- 멱등 메서드
  - GET : 한 번 조회하든 몇 번을 조회하든 같은 결과가 조회된다. (멱등)
  - PUT: 결과를 대체한다. 따라서 같은 요청을 여러번 해도 최종 결과는 같다. (멱등)
  - DELETE : 결과를 삭제한다. 같은 요청을 여러번 해도 삭제된 결과는 똑같다. (멱등)
  - POST : 멱등이 아니다. 두 번 호출하면 같은 결제가 중복해서 발생할 수 있다. (멱등X)
#### 멱등 활용
- 자동 복구 매커니즘에 활용
  - 서버가 TIMEOUT 등으로 정상 응답을 못주었을 때, 클라이언트가 같은 요청을 다시 해도 되는가? 판단 근거
    - 풀어서 설명: 클라이언트에서 DELETE 메서드로 요청을 보냈는데 응답을 받지 못했다. 그래서 클라이언트는 제대로 된건가? 싶어서 다시 한번 DELETE요청을 했다. DELETE는 멱등한 메서드기 때문에 괜찮다.
- Q: 재요청 중간에 다른 곳에서 리소스를 변경 해버리면?
  - 사용자1: GET -> username:A, age:20
  - 사용자2: PUT -> username:A, age:30
  - 사용자1: GET -> username:A, age:30 -> 사용자2의 영향으로 바뀐 데이터 조회
- A: 멱등은 외부 요인으로 중간에 바뀐 리소스가 변경되는것 까지 고려하지는 않는다.
  - 동일한 사용자가 똑같은 요청을 여러번 한 것에대해서만 고려한다.

### 캐시 가능 Cacheable
- 응답 결과 리소스를 캐시해서 사용해도 되는가?
- GET, HEAD, POST, PATCH 캐시 가능
- 실제로는 GET, HEAD 메서드 정도만 캐시로 사용 (URL만 key로 잡고 캐시를 하면 되서 심플하다)
  - POST, PATCH는 본문 내용까지 캐시 키로 고려해야하는데, 구현이 쉽지 않고 복잡하다.